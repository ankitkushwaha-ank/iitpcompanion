{% extends 'base.html' %}
{% load static %}
{% block title %}Your Assignments | IITP Companion{% endblock %}

{% block content %}
<head>
  <link rel="stylesheet" href="{% static '/css/Assigment.css' %}">
  <style>
    .circle-button {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid #3b82f6;
      background-color: transparent;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .circle-button.completed {
      background-color: #3b82f6;
    }

    .priority-text.high-priority {
      color: #ef4444;
    }

    .priority-text.medium-priority {
      color: #facc15;
    }

    .priority-text.low-priority {
      color: #10b981;
    }

    form.assignment-form {
      display: inline-block;
      margin-right: 12px;
    }
  </style>
</head>

<body>
  <section class="status">
    <div class="card">
      <div class="total">
        <p>Total</p>
        <p class="boldno">{{ total }}</p>
      </div>
      <div class="icon">
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" class="lucide-book-open h-8 w-8 text-primary">
          <path d="M12 7v14"></path>
          <path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path>
        </svg>
      </div>
    </div>

    <div class="card">
      <div class="total">
        <p>Completed</p>
        <p class="boldt boldno">{{ completed }}</p>
      </div>
      <div class="icon">
        <svg width="24" height="24" fill="none" stroke="green" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" class="lucide-check h-8 w-8 text-green-600">
          <path d="M20 6 9 17l-5-5"></path>
        </svg>
      </div>
    </div>

    <div class="card">
      <div class="total">
        <p>Pending</p>
        <p class="boldp boldno">{{ pending }}</p>
      </div>
      <div class="icon">
        <svg width="24" height="24" fill="none" stroke="red" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" class="lucide-calendar h-8 w-8 text-red-600">
          <path d="M8 2v4"></path>
          <path d="M16 2v4"></path>
          <rect width="18" height="18" x="3" y="4" rx="2"></rect>
          <path d="M3 10h18"></path>
        </svg>
      </div>
    </div>
  </section>

  <section class="main">
    <div class="main-h">
      <h2>Your Assignments</h2>
    </div>

    <div class="main-cards">
      {% for a in assignments %}
      <div class="main-card">
        <div class="mainc-head">
          <div>
            <form method="post" action="{% url 'toggle_assignment_status' %}" class="assignment-form">
              {% csrf_token %}
              <input type="hidden" name="assignment_id" value="{{ a.id }}">
              <button type="submit"
                class="circle-button {% if a.status == 'completed' %}completed{% endif %}"></button>
            </form>
          </div>
          <div>
            <h2>{{ a.title }}</h2>
          </div>
        </div>

        <div class="main-data">
          <div class="main-date">
            <p>Due: {{ a.due_start|date:"d M" }} - {{ a.due_end|date:"d M" }}</p>
          </div>
          <div class="priority">
            <p class="priority-text {{ a.priority }}-priority">{{ a.priority|title }} Priority</p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
</body>
{% endblock %}
